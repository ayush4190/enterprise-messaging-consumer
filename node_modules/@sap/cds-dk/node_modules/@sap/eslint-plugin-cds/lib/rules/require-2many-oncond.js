module.exports = {
  meta: {
    docs: {
      description: `Foreign key information of a \`TO MANY\` relationship must be defined within the target and specified in an \`ON\` condition.`,
      category: "Model Validation",
      recommended: true,
      version: "2.1.0",
    },
    severity: "error",
    type: "problem",
  },
  create: function (context) {

    return { element: check_2many_oncond }

    function check_2many_oncond(e) {
      if (e.is2many && !e.on && typeof e.target === 'string') {
        const loc = context.cds.getLocation(e.name, e);
        return {
          message: `You must provide an \`ON\` condition for \`TO MANY\` relationship '${e.name}'.`,
          loc,
          file: e.parent.$location.file,
        };
      }
    }
  },
};
